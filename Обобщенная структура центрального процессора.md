# 2. Обобщенная структура центрального процессора (ЦП). Функционирование ЦП во времени: цикл шины, цикл команд.

#Редактор_Шашаев_Кирилл

## Краткий ответ

### Структура ЦП
Основные элементы:
- **АЛУ** - выполняет *арифметические* и *логические команды*
- **УУ** - управляем взаимодействием отдельных компонентов, для этого посылает УП (**управляющие сигналы**) к отдельным компонентам или изменяет **состояние процессора** (значение регистров)
- **Регистры** - высокоскоростная память процессора, которая представляет состояние ЦП. Виды регистров: регистры общего назначения (a, ax, eax), **указатель команд** (Instruction Pointer), регистры флагов, и тд.
Дополнительные элементы ЦП:
- **Кэш память** - *буфер между ЦП и оперативной памятью* (буфер обмена между медленным устройством хранения данных и более быстрым)
- **Интерфейсный блок** - компонент, который предоставляет интерфейс для взаимодействия со внешними устройствами (память, устройства ввода/вывода)

Структура центрального процессора на более детальном уровне также зависит от архитектуры процессора ([[Понятие RISC и CISC процессора|RISC и CISC]]).

![[Pasted image 20250614110308.png]]

### Цикл команд (или этапы выполнения команды)
1. **Выборка команды** - извлечение команды из памяти
2. **Декодирование команды** - определение *типа операции* (**арифметическая**, **логическая**, **пересылка данных**), *кол-ва операндов*, *режима адресации*
3. **Вычисление исполнительных адресов** - приведение адреса к **физическому виду**, если это не так
4. **Выборка операндов** - извлечение операндов из памяти
5. **Исполнение операции**
6. **Запись результата** - запись в память
7. **Формирование адреса следующей команды**

**Цикл шины** (*машинный цикл, цикл магистрали*) - **однократный** обмен информацией между *процессором и памятью*, или *процессором и периферийным устройством*.

Этапы цикла шины:
1. Устройство хочет передать данные по шине и посылает сигнал **контроллеру шины** (КШ)
2. После освобождения шины **КШ** подаёт **сигнал** устройству, что тот может *занять шину в свой пользование*
3. Передача данных
4. После передачи всех данных устройство посылает по шине сигнал, что данные отправлены в полном объёме, передача данный завершается

**Цикл команды** может состоять из одного или нескольких **циклов шины**.

---
## Первоисточник информации
---

**Структура ЦП**:

![[Pasted image 20250614110308.png]]

Каждый **ЦП** имеет:
1) Определённое число элементов памяти - **регистров** (разрядность обычно 8 - 64 **бита**)
2) Арифметико - логическое устройство (**АЛУ**)
3) Устройство управления (**УУ**)

**Регистры** (или ЗУ) используются для временного хранения исполняемой **команды**, **адресов памяти**, **обрабатываемых данных** и другой внутренней информации ЦП.

Помимо регистров в процессорах имеется и сверхбыстрая память небольшого объёма – кэш (сache) - запоминающее устройство с малым временем доступа. **Кэш** - *буфер между ЦП и оперативной памятью* (буфер обмена между медленным устройством хранения данных и более быстрым). Принцип его действия основан на том, что простой более быстрого устройства сильно влияет на суммарную производительность, а также - что с **наибольшей вероятностью** запрашиваются данные, сохраненные сравнительно **недавно**. Поэтому между устройствами помещают небольшой (по сравнению со всеми хранимыми данными) буфер относительно быстрой памяти (обычно статической памяти SRAM, StaticRandom Access Memory, которая использует статический триггер, выполненный на транзисторных ключах). Это позволяет снизить потери быстрого устройства как на записи (запись производится в быстрый буфер, а последующая перезапись в медленное устройство производится уже без участия быстрого), так и на чтении (недавно записанные данные доступны для чтения из "быстрого" буфера.

Применение статической памяти, как правило, ограничено относительно небольшой по объему кэш-памятью первого (Level 1 - L1), второго (L2) или третьего (L3) уровней (если она не интегрирована на один кристалл с процессором). Так, объем L2 (L3) обычно не превышает 1-2 Мб (чаще всего он составляет 256-512 Кб). Объем еще более быстрого L1 (как правило, интегрируемого на кристалле с процессором) - вообще до 64 Кб.

Арифметико - логическое устройство (АЛУ) производит арифметическую и логическую обработку данных. **АЛУ** может в себе содержать сразу множество **ВЭ** (вычислительных элементов), которые *заранее определены* под свои узки задачи (сложение, вычитание, побитовое или).

УУ формирует и подает во все блоки машины в нужные моменты времени определенные сигналы управления (управляющие импульсы), обусловленные спецификой выполняемой операции и результатами предыдущих операций; формирует адреса ячеек памяти, используемых выполняемой операцией, и передает эти адреса в соответствующие блоки ЭВМ. Опорную последовательность импульсов УУ получает от *генератора тактовых импульсов*. Тем самым он координирует другие компоненты. 

**Генератор тактовых импульсов** вырабатывает последовательность электрических импульсов; частота генерируемых импульсов определяет тактовую частоту машины. Каждый импульс переключает шаг обработки, необходимый для завершения машинной команды (на одну команду может потребоваться несколько шагов). Промежуток времени между соседними импульсами определяет время одного такта работы машины или просто такт работы машины. **Такт** - время для передачи некоторого значения от одного регистра к другому внутри **ЦП**. Каждый такт **ГТ** (генератор тактов) как бы бьёт в **барабан**, позволяя в этом момент всем компонента ПК работать совместно.

Программа в **фон-неймановской ЭВМ** реализуется **ЦП** посредством последовательного исполнения образующих эту программу команд. Действия, требуемые для выборки (извлечения из основной памяти) и выполнения команды, называют **циклом команды**. В общем случае цикл команды включает в себя несколько этапов:
1. **Выборку команды (ВК)**
2. **Декодирование команды (ДК)**
3. **Вычисление исполнительных адресов (ВА)**
4. **Выборку операндов (ВО)**
5. **Исполнение операции (ИО)**
6. **Запись результата (ЗР)**
7. **Формирование адреса следующей команды (ФАСК)**

Перечисленные этапы выполнения команды в дальнейшем будем называть  **стандартным циклом команды**. Отметим, что не все из этапов присутствуют при выполнении любой команды, тем не менее этапы *выборки, декодирования, исполнения и формирования адреса следующей команды* имеют место всегда.

## Цикл шины

![[Pasted image 20250614182206.png]]

![[Pasted image 20250614110351.png]]